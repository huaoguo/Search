create table temp (id integer primary key,idf real);insert into temp(id,idf)select dict_id,log(2,cast(8926 as real)/count(doc_id)) idffrom dict_docgroup by dict_idupdate dict set idf = (select temp.idf from temp where temp.id = dict.id)select dd.id,dd.tf,dd.tf2,0.4+0.6*dd.tf/t.max_tf tf3,t.max_tf from dict_doc ddinner join (select doc_id,max(tf) max_tf from dict_docgroup by doc_id) t on dd.doc_id = t.doc_id